<div class="container">
  <%= form_for @exam, url: admin_exams_path, html: {class:"form-row"} do |f| %>
    <div class="row">
      <div class="col-lg-6">
        <div class="form-outline flex-fill mb-0 ">
          <%= f.label :name, class:"form-label" %>
          <%= f.text_field :name, class:"form-control w-100" %>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="form-outline flex-fill mb-0 ">
          <%= f.label :tag, class:"form-label" %>
          <%= f.select(:tag_id, options_for_select(
            @tags.map do |tag| 
              ([tag.name, tag.id])
            end,
            @prev_search_tag
          ),{}, :class => "form-select me-2 w-100"
        ) %>
        </div>
      </div>
      <div class="col-lg-2">
        <div class="form-outline flex-fill mb-0">
          <%= f.label :timeout, class:"form-label" %>
          <%= f.number_field :timeout, class:"form-control w-100" %>
        </div>
      </div>
    </div>
    <div class="form-outline flex-fill mb-0">
      <%= f.label :description, class:"form-label" %>
      <%= f.text_area :description, class:"form-control" %>
    </div>
    <div class="mt-3" >
      <%= f.submit "Create", class:"btn btn-primary"%>
    </div>
    <div class="btn btn-primary" id="add-question">Add Question</div>
    <div id="questions-box">
      <div class="question-box">
        <%= render :partial => "layouts/form", locals: {f: f, child_index: Time.now.to_i} %>
      </div>
    </div>
  <% end %>
</div>
<script>
  $("#add-question").on("click", function(e) {
    var index = $("#questions-box .question-box:last").index()
    var temp = $("#questions-box .question-box:last").wrap('<p/>').parent().html().replaceAll(`[questions_attributes][${index}]`, `[questions_attributes][${index+1}]`)
    $("#questions-box .question-box:last").unwrap();

    $("#questions-box").append(temp)

    console.log(index)
  });
</script>
